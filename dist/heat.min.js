"use strict";var Constant,Is,Data,DomElement,DateTime,ToolTip,Trigger,binding;(Constant||(Constant={})).HEAT_JS_ATTRIBUTE_NAME="data-heat-js",(e=>{function t(e){return null!=e&&""!==e.toString()}function n(e){return t(e)&&"object"==typeof e}function o(e){return n(e)&&e instanceof Array}e.defined=t,e.definedObject=n,e.definedBoolean=function(e){return t(e)&&"boolean"==typeof e},e.definedString=function(e){return t(e)&&"string"==typeof e},e.definedFunction=function(e){return t(e)&&"function"==typeof e},e.definedNumber=function(e){return t(e)&&"number"==typeof e},e.definedArray=o,e.definedDate=function(e){return n(e)&&e instanceof Date},e.invalidOptionArray=function(e,t=1){return!o(e)||e.length<t}})(Is||(Is={})),(e=>{let t;var n;function o(e,t){return Is.definedArray(e)?e:t}(n=t=e.String||(e.String={})).newGuid=function(){const e=[];for(let t=0;t<32;t++){8!==t&&12!==t&&16!==t&&20!==t||e.push("-");const n=Math.floor(16*Math.random()).toString(16);e.push(n)}return e.join("")},n.padNumber=function(e){const t=e.toString();return 1===t.length?"0"+t:t},n.startsWithAnyCase=function(e,t){return e.substring(0,t.length).toLowerCase()===t.toLowerCase()},e.getDefaultAnyString=function(e,t){return"string"==typeof e?e:t},e.getDefaultString=function(e,t){return Is.definedString(e)?e:t},e.getDefaultBoolean=function(e,t){return Is.definedBoolean(e)?e:t},e.getDefaultNumber=function(e,t){return Is.definedNumber(e)?e:t},e.getDefaultFunction=function(e,t){return Is.definedFunction(e)?e:t},e.getDefaultArray=o,e.getDefaultObject=function(e,t){return Is.definedObject(e)?e:t},e.getDefaultStringOrArray=function(e,t){let n=t;if(Is.definedString(e)){const o=e.toString().split(" ");0===o.length?e=t:n=o}else n=o(e,t);return n}})(Data||(Data={})),(e=>{function t(e,t,n="",o=null){const a=t.toLowerCase();let i="text"===a?document.createTextNode(""):document.createElement(a);return Is.defined(n)&&(i.className=n),Is.defined(o)?e.insertBefore(i,o):e.appendChild(i),i}function n(e,n,o,a,i=null){const r=t(e,n,o,i);return r.innerHTML=a,r}function o(){const e=document.documentElement;return{left:e.scrollLeft-(e.clientLeft||0),top:e.scrollTop-(e.clientTop||0)}}e.createWithNoContainer=function(e){const t=e.toLowerCase();return"text"===t?document.createTextNode(""):document.createElement(t)},e.create=t,e.createWithHTML=n,e.getStyleValueByName=function(e,t,n=!1){let o=getComputedStyle(e).getPropertyValue(t);return n&&(o=parseFloat(o)),o},e.addClass=function(e,t){e.classList.add(t)},e.removeClass=function(e,t){e.classList.remove(t)},e.cancelBubble=function(e){e.preventDefault(),e.stopPropagation()},e.getScrollPosition=o,e.showElementAtMousePosition=function(e,t){let n=e.pageX,a=e.pageY;const i=o();t.style.display="block",n+t.offsetWidth>window.innerWidth?n-=t.offsetWidth:n++,a+t.offsetHeight>window.innerHeight?a-=t.offsetHeight:a++,n<i.left&&(n=e.pageX+1),a<i.top&&(a=e.pageY+1),t.style.left=`${n}px`,t.style.top=`${a}px`},e.reverseChildrenOrder=function(e){const t=e.children;let n=t.length-1;for(;n--;)e.appendChild(t[n])},e.createCheckBox=function(e,o){const a=t(e,"div"),i=t(a,"label","checkbox"),r=t(i,"input");return r.type="checkbox",t(i,"span","check-mark"),n(i,"span","text",o),r}})(DomElement||(DomElement={})),(e=>{function t(e){return e.getDay()-1<0?6:e.getDay()-1}function n(e,t){let n=e.text.thText;return 31===t||21===t||1===t?n=e.text.stText:22===t||2===t?n=e.text.ndText:23!==t&&3!==t||(n=e.text.rdText),n}e.getTotalDaysInMonth=function(e,t){return new Date(e,t+1,0).getDate()},e.getWeekdayNumber=t,e.getDayOrdinal=n,e.getCustomFormattedDateText=function(e,o,a){let i=o;const r=t(a);return i=i.replace("{dddd}",e.text.dayNames[r]),i=i.replace("{dd}",Data.String.padNumber(a.getDate())),i=i.replace("{d}",a.getDate().toString()),i=i.replace("{o}",n(e,a.getDate())),i=i.replace("{mmmm}",e.text.monthNames[a.getMonth()]),i=i.replace("{mm}",Data.String.padNumber(a.getMonth()+1)),i=i.replace("{m}",(a.getMonth()+1).toString()),i=i.replace("{yyyy}",a.getFullYear().toString()),i=i.replace("{yyy}",a.getFullYear().toString().substring(1)),i=i.replace("{yy}",a.getFullYear().toString().substring(2)),i=i.replace("{y}",parseInt(a.getFullYear().toString().substring(2)).toString()),i},e.toStorageDate=function(e){return e.getFullYear()+"-"+Data.String.padNumber(e.getMonth()+1)+"-"+Data.String.padNumber(e.getDate())},e.getStorageDate=function(e){return e.split("-")},e.getStorageDateYear=function(e){return e.split("-")[0]}})(DateTime||(DateTime={})),(e=>{function t(e,t=!0){let n=t?window.addEventListener:window.removeEventListener,a=t?document.addEventListener:document.removeEventListener;n("mousemove",(()=>{o(e)})),a("scroll",(()=>{o(e)}))}function n(e,t,n){DomElement.cancelBubble(e),o(t),t._currentView.tooltipTimer=setTimeout((()=>{t._currentView.tooltip.innerHTML=n,t._currentView.tooltip.style.display="block",DomElement.showElementAtMousePosition(e,t._currentView.tooltip)}),t.tooltip.delay)}function o(e){Is.defined(e._currentView.tooltip)&&(0!==e._currentView.tooltipTimer&&(clearTimeout(e._currentView.tooltipTimer),e._currentView.tooltipTimer=0),"none"!==e._currentView.tooltip.style.display&&(e._currentView.tooltip.style.display="none"))}e.renderControl=function(e){Is.defined(e._currentView.tooltip)||(e._currentView.tooltip=DomElement.create(document.body,"div","heat-js-tooltip"),e._currentView.tooltip.style.display="none",t(e))},e.assignToEvents=t,e.add=function(e,t,o){null!==e&&(e.onmousemove=e=>{n(e,t,o)})},e.show=n,e.hide=o})(ToolTip||(ToolTip={})),(Trigger||(Trigger={})).customEvent=function(e,...t){let n=null;return Is.definedFunction(e)&&(n=e.apply(null,[].slice.call(t,0))),n},(e=>{let t;(e=>{const t=[1,2,3,4,5,6,7,8,9,10,11,12],n=[1,2,3,4,5,6,7];e.get=function(e){let o=Data.getDefaultObject(e,{});return o.views=Data.getDefaultObject(o.views,{}),o.exportOnlyYearBeingViewed=Data.getDefaultBoolean(o.exportOnlyYearBeingViewed,!0),o.year=Data.getDefaultNumber(o.year,(new Date).getFullYear()),o.view=Data.getDefaultString(o.view,"map"),o.exportType=Data.getDefaultString(o.exportType,"csv"),o.useLocalStorageForData=Data.getDefaultBoolean(o.useLocalStorageForData,!1),o.allowFileImports=Data.getDefaultBoolean(o.allowFileImports,!0),o.yearsToHide=Data.getDefaultArray(o.yearsToHide,[]),o.dataFetchDelay=Data.getDefaultNumber(o.dataFetchDelay,6e4),o.showOnlyDataForYearsAvailable=Data.getDefaultBoolean(o.showOnlyDataForYearsAvailable,!1),o.showHolidaysInDayToolTips=Data.getDefaultBoolean(o.showHolidaysInDayToolTips,!1),o=function(e){if(Is.definedArray(e.colorRanges)){const t=e.colorRanges.length;for(let n=0;n<t;n++){const t=e.colorRanges[n];t.id=Data.getDefaultString(t.id,Data.String.newGuid()),t.name=Data.getDefaultString(t.name,""),t.minimum=Data.getDefaultNumber(t.minimum,0),t.cssClassName=Data.getDefaultString(t.cssClassName,""),t.mapCssClassName=Data.getDefaultString(t.mapCssClassName,""),t.chartCssClassName=Data.getDefaultString(t.chartCssClassName,""),t.statisticsCssClassName=Data.getDefaultString(t.statisticsCssClassName,""),t.tooltipText=Data.getDefaultString(t.tooltipText,""),t.visible=Data.getDefaultBoolean(t.visible,!0)}}else e.colorRanges=[{id:Data.String.newGuid(),name:"Day Color 1",minimum:10,cssClassName:"day-color-1",tooltipText:"Day Color 1",visible:!0},{id:Data.String.newGuid(),name:"Day Color 2",minimum:15,cssClassName:"day-color-2",tooltipText:"Day Color 2",visible:!0},{id:Data.String.newGuid(),name:"Day Color 3",minimum:20,cssClassName:"day-color-3",tooltipText:"Day Color 3",visible:!0},{id:Data.String.newGuid(),name:"Day Color 4",minimum:25,cssClassName:"day-color-4",tooltipText:"Day Color 4",visible:!0}];return e}(o),o=function(e){if(Is.definedArray(e.holidays)){const t=e.holidays.length;for(let n=0;n<t;n++){const t=e.holidays[n];t.date=Data.getDefaultString(t.date,""),t.name=Data.getDefaultString(t.name,""),t.showInViews=Data.getDefaultBoolean(t.showInViews,!0)}}else e.holidays=[];return e}(o),o=function(e){return e.title=Data.getDefaultObject(e.title,{}),e.title.text=Data.getDefaultString(e.title.text,"Heat.js"),e.title.showText=Data.getDefaultBoolean(e.title.showText,!0),e.title.showYearSelector=Data.getDefaultBoolean(e.title.showYearSelector,!0),e.title.showRefreshButton=Data.getDefaultBoolean(e.title.showRefreshButton,!1),e.title.showExportButton=Data.getDefaultBoolean(e.title.showExportButton,!1),e.title.extraSelectionYears=Data.getDefaultNumber(e.title.extraSelectionYears,50),e.title.showYearSelectionDropDown=Data.getDefaultBoolean(e.title.showYearSelectionDropDown,!0),e.title.showImportButton=Data.getDefaultBoolean(e.title.showImportButton,!1),e.title.showConfigurationButton=Data.getDefaultBoolean(e.title.showConfigurationButton,!0),e.title.showTitleDropDownButton=Data.getDefaultBoolean(e.title.showTitleDropDownButton,!0),e.title.showTitleDropDownHeaders=Data.getDefaultBoolean(e.title.showTitleDropDownHeaders,!0),e}(o),o=function(e){return e.description=Data.getDefaultObject(e.description,{}),e.description.text=Data.getDefaultString(e.description.text,""),e.description.url=Data.getDefaultString(e.description.url,""),e.description.urlTarget=Data.getDefaultString(e.description.urlTarget,"_blank"),e}(o),o=function(e){return e.guide=Data.getDefaultObject(e.guide,{}),e.guide.enabled=Data.getDefaultBoolean(e.guide.enabled,!0),e.guide.colorRangeTogglesEnabled=Data.getDefaultBoolean(e.guide.colorRangeTogglesEnabled,!0),e.guide.showLessAndMoreLabels=Data.getDefaultBoolean(e.guide.showLessAndMoreLabels,!0),e.guide.showNumbersInGuide=Data.getDefaultBoolean(e.guide.showNumbersInGuide,!1),e}(o),o=function(e){return e.tooltip=Data.getDefaultObject(e.tooltip,{}),e.tooltip.delay=Data.getDefaultNumber(e.tooltip.delay,750),e.tooltip.dayText=Data.getDefaultString(e.tooltip.dayText,"{d}{o} {mmmm} {yyyy}"),e}(o),o=function(e){e.views.map=Data.getDefaultObject(e.views.map,{}),e.views.map.showMonthDayGaps=Data.getDefaultBoolean(e.views.map.showMonthDayGaps,!0),e.views.map.showDayNames=Data.getDefaultBoolean(e.views.map.showDayNames,!0),e.views.map.placeMonthNamesOnTheBottom=Data.getDefaultBoolean(e.views.map.placeMonthNamesOnTheBottom,!1),e.views.map.showDayNumbers=Data.getDefaultBoolean(e.views.map.showDayNumbers,!1),e.views.map.showMonthNames=Data.getDefaultBoolean(e.views.map.showMonthNames,!0),e.views.map.showDaysInReverseOrder=Data.getDefaultBoolean(e.views.map.showDaysInReverseOrder,!1),e.views.map.showNoDataMessageWhenDataIsNotAvailable=Data.getDefaultBoolean(e.views.map.showNoDataMessageWhenDataIsNotAvailable,!1),e.views.map.showMinimalDayNames=Data.getDefaultBoolean(e.views.map.showMinimalDayNames,!1),e.views.map.showMonthsInReverseOrder=Data.getDefaultBoolean(e.views.map.showMonthsInReverseOrder,!1),e.views.map.keepScrollPositions=Data.getDefaultBoolean(e.views.map.keepScrollPositions,!1),Is.invalidOptionArray(e.views.map.monthsToShow)&&(e.views.map.monthsToShow=t);Is.invalidOptionArray(e.views.map.daysToShow)&&(e.views.map.daysToShow=n);return e}(o),o=function(e){e.views.chart=Data.getDefaultObject(e.views.chart,{}),e.views.chart.enabled=Data.getDefaultBoolean(e.views.chart.enabled,!0),e.views.chart.showChartYLabels=Data.getDefaultBoolean(e.views.chart.showChartYLabels,!0),e.views.chart.showMonthNames=Data.getDefaultBoolean(e.views.chart.showMonthNames,!0),e.views.chart.showLineNumbers=Data.getDefaultBoolean(e.views.chart.showLineNumbers,!1),e.views.chart.showInReverseOrder=Data.getDefaultBoolean(e.views.chart.showInReverseOrder,!1),e.views.chart.keepScrollPositions=Data.getDefaultBoolean(e.views.chart.keepScrollPositions,!1),Is.invalidOptionArray(e.views.chart.monthsToShow)&&(e.views.chart.monthsToShow=t);Is.invalidOptionArray(e.views.chart.daysToShow)&&(e.views.chart.daysToShow=n);return e}(o),o=function(e){e.views.days=Data.getDefaultObject(e.views.days,{}),e.views.days.enabled=Data.getDefaultBoolean(e.views.days.enabled,!0),e.views.days.showChartYLabels=Data.getDefaultBoolean(e.views.days.showChartYLabels,!0),e.views.days.showDayNames=Data.getDefaultBoolean(e.views.days.showDayNames,!0),e.views.days.showInReverseOrder=Data.getDefaultBoolean(e.views.days.showInReverseOrder,!1),e.views.days.showDayNumbers=Data.getDefaultBoolean(e.views.days.showDayNumbers,!1),e.views.days.keepScrollPositions=Data.getDefaultBoolean(e.views.days.keepScrollPositions,!1),Is.invalidOptionArray(e.views.days.monthsToShow)&&(e.views.days.monthsToShow=t);Is.invalidOptionArray(e.views.days.daysToShow)&&(e.views.days.daysToShow=n);return e}(o),o=function(e){e.views.statistics=Data.getDefaultObject(e.views.statistics,{}),e.views.statistics.enabled=Data.getDefaultBoolean(e.views.statistics.enabled,!0),e.views.statistics.showChartYLabels=Data.getDefaultBoolean(e.views.statistics.showChartYLabels,!0),e.views.statistics.showColorRangeLabels=Data.getDefaultBoolean(e.views.statistics.showColorRangeLabels,!0),e.views.statistics.useColorRangeNamesForLabels=Data.getDefaultBoolean(e.views.statistics.useColorRangeNamesForLabels,!1),e.views.statistics.showRangeNumbers=Data.getDefaultBoolean(e.views.statistics.showRangeNumbers,!1),e.views.statistics.showInReverseOrder=Data.getDefaultBoolean(e.views.statistics.showInReverseOrder,!1),e.views.statistics.keepScrollPositions=Data.getDefaultBoolean(e.views.statistics.keepScrollPositions,!1),Is.invalidOptionArray(e.views.statistics.monthsToShow)&&(e.views.statistics.monthsToShow=t);Is.invalidOptionArray(e.views.statistics.daysToShow)&&(e.views.statistics.daysToShow=n);return e}(o),o=function(e){return e.events=Data.getDefaultObject(e.events,{}),e.events.onDayClick=Data.getDefaultFunction(e.events.onDayClick,null),e.events.onBackYear=Data.getDefaultFunction(e.events.onBackYear,null),e.events.onNextYear=Data.getDefaultFunction(e.events.onNextYear,null),e.events.onRefresh=Data.getDefaultFunction(e.events.onRefresh,null),e.events.onBeforeRender=Data.getDefaultFunction(e.events.onBeforeRender,null),e.events.onRenderComplete=Data.getDefaultFunction(e.events.onRenderComplete,null),e.events.onDestroy=Data.getDefaultFunction(e.events.onDestroy,null),e.events.onExport=Data.getDefaultFunction(e.events.onExport,null),e.events.onSetYear=Data.getDefaultFunction(e.events.onSetYear,null),e.events.onTypeSwitch=Data.getDefaultFunction(e.events.onTypeSwitch,null),e.events.onDayToolTipRender=Data.getDefaultFunction(e.events.onDayToolTipRender,null),e.events.onAdd=Data.getDefaultFunction(e.events.onAdd,null),e.events.onRemove=Data.getDefaultFunction(e.events.onRemove,null),e.events.onReset=Data.getDefaultFunction(e.events.onReset,null),e.events.onViewSwitch=Data.getDefaultFunction(e.events.onViewSwitch,null),e.events.onColorRangeTypeToggle=Data.getDefaultFunction(e.events.onColorRangeTypeToggle,null),e.events.onImport=Data.getDefaultFunction(e.events.onImport,null),e.events.onStatisticClick=Data.getDefaultFunction(e.events.onStatisticClick,null),e.events.onDataFetch=Data.getDefaultFunction(e.events.onDataFetch,null),e.events.onClear=Data.getDefaultFunction(e.events.onClear,null),e.events.onUpdate=Data.getDefaultFunction(e.events.onUpdate,null),e.events.onOptionsUpdate=Data.getDefaultFunction(e.events.onOptionsUpdate,null),e.events.onWeekDayClick=Data.getDefaultFunction(e.events.onWeekDayClick,null),e}(o),o}})(t=e.options||(e.options={}))})(binding||(binding={})),(()=>{let _configuration={},_elements_Day_Width=0,_elements_DateCounts={};const _internal_Name_Holiday="HOLIDAY",_local_Storage_Start_ID="HJS_";function renderDisabledBackground(e){e._currentView.disabledBackground=DomElement.create(e._currentView.element,"div","disabled")}function showDisabledBackground(e){Is.defined(e._currentView.disabledBackground)&&"block"!==e._currentView.disabledBackground.style.display&&(e._currentView.disabledBackground.style.display="block")}function hideDisabledBackground(e){Is.defined(e._currentView.disabledBackground)&&"none"!==e._currentView.disabledBackground.style.display&&(e._currentView.disabledBackground.style.display="none")}function render(){const e=_configuration.domElementTypes,t=e.length;for(let n=0;n<t;n++){const t=document.getElementsByTagName(e[n]),o=[].slice.call(t),a=o.length;for(let e=0;e<a&&renderElement(o[e]);e++);}}function renderElement(e){let t=!0;if(Is.defined(e)&&e.hasAttribute(Constant.HEAT_JS_ATTRIBUTE_NAME)){const n=e.getAttribute(Constant.HEAT_JS_ATTRIBUTE_NAME);if(Is.definedString(n)){const o=getObjectFromString(n);o.parsed&&Is.definedObject(o.object)?renderControl(renderBindingOptions(o.object,e)):_configuration.safeMode||(console.error(_configuration.text.attributeNotValidErrorText.replace("{{attribute_name}}",Constant.HEAT_JS_ATTRIBUTE_NAME)),t=!1)}else _configuration.safeMode||(console.error(_configuration.text.attributeNotSetErrorText.replace("{{attribute_name}}",Constant.HEAT_JS_ATTRIBUTE_NAME)),t=!1)}return t}function renderBindingOptions(e,t){const n=binding.options.get(e),o=Data.getDefaultString(n.view,"").toLowerCase();let a={};return a.element=t,a.disabledBackground=null,a.configurationDialog=null,a.dayCheckBoxes=[],a.monthCheckBoxes=[],a.tooltip=null,a.tooltipTimer=0,a.mapContents=null,a.mapContentsScrollLeft=0,a.year=n.year,a.type=_configuration.text.unknownTrendText,a.isInFetchMode=Is.definedFunction(n.events.onDataFetch),a.isInFetchModeTimer=0,a.yearsAvailable=[],n.views.chart.enabled&&(a.chartContents=null,a.chartContentsScrollLeft=0),n.views.days.enabled&&(a.daysContents=null,a.daysContentsScrollLeft=0),n.views.statistics.enabled&&(a.statisticsContents=null,a.statisticsContentsScrollLeft=0),a.view="map"===o?1:"chart"===o?2:"days"===o?3:"statistics"===o?4:1,n._currentView=a,n}function renderControl(e){Trigger.customEvent(e.events.onBeforeRender,e._currentView.element),Is.definedString(e._currentView.element.id)||(e._currentView.element.id=Data.String.newGuid()),""===e._currentView.element.className.trim()?e._currentView.element.className="heat-js":DomElement.addClass(e._currentView.element,"heat-js"),e._currentView.element.removeAttribute(Constant.HEAT_JS_ATTRIBUTE_NAME),createDateStorageForElement(e._currentView.element.id,e),renderControlContainer(e),Trigger.customEvent(e.events.onRenderComplete,e._currentView.element)}function renderControlContainer(e,t=!1,n=!1){t&&storeDataInLocalStorage(e),Is.defined(e._currentView.mapContents)&&(e._currentView.mapContentsScrollLeft=e._currentView.mapContents.scrollLeft),e.views.chart.enabled&&Is.defined(e._currentView.chartContents)&&(e._currentView.chartContentsScrollLeft=e._currentView.chartContents.scrollLeft),e.views.days.enabled&&Is.defined(e._currentView.daysContents)&&(e._currentView.daysContentsScrollLeft=e._currentView.daysContents.scrollLeft),e.views.statistics.enabled&&Is.defined(e._currentView.statisticsContents)&&(e._currentView.statisticsContentsScrollLeft=e._currentView.statisticsContents.scrollLeft),e._currentView.element.innerHTML="",e._currentView.yearsAvailable=getYearsAvailableInData(e),ToolTip.hide(e),startDataPullTimer(e),e.title.showConfigurationButton&&(renderDisabledBackground(e),renderConfigurationDialog(e)),ToolTip.renderControl(e),renderControlTitleBar(e),renderControlMap(e,n),e.views.chart.enabled&&(renderControlChart(e,n),e._currentView.chartContents.style.display="none"),e.views.days.enabled&&(renderControlDays(e,n),e._currentView.daysContents.style.display="none"),e.views.statistics.enabled&&(renderControlStatistics(e,n),e._currentView.statisticsContents.style.display="none"),e._currentView.mapContents.style.display="none",1===e._currentView.view?e._currentView.mapContents.style.display="block":e.views.chart.enabled&&2===e._currentView.view?e._currentView.chartContents.style.display="block":e.views.days.enabled&&3===e._currentView.view?e._currentView.daysContents.style.display="block":e.views.statistics.enabled&&4===e._currentView.view?e._currentView.statisticsContents.style.display="block":(e._currentView.view=1,e._currentView.mapContents.style.display="block")}function renderConfigurationDialog(e){e._currentView.configurationDialog=DomElement.create(e._currentView.disabledBackground,"div","dialog configuration");const t=DomElement.create(e._currentView.configurationDialog,"div","dialog-title-bar"),n=DomElement.create(e._currentView.configurationDialog,"div","dialog-contents"),o=DomElement.create(t,"div","dialog-close"),a=DomElement.create(n,"div","side-container panel"),i=DomElement.create(n,"div","side-container panel");DomElement.createWithHTML(t,"span","dialog-title-bar-text",_configuration.text.configurationTitleText),DomElement.createWithHTML(a,"div","side-container-title-text",_configuration.text.visibleDaysText+":"),DomElement.createWithHTML(i,"div","side-container-title-text",_configuration.text.visibleMonthsText+":");const r=DomElement.create(i,"div","side-container"),s=DomElement.create(i,"div","side-container");o.onclick=()=>{hideConfigurationDialog(e)};for(let t=0;t<7;t++)e._currentView.dayCheckBoxes[t]=DomElement.createCheckBox(a,_configuration.text.dayNames[t]);for(let t=0;t<7;t++)e._currentView.monthCheckBoxes[t]=DomElement.createCheckBox(r,_configuration.text.monthNames[t]);for(let t=7;t<12;t++)e._currentView.monthCheckBoxes[t]=DomElement.createCheckBox(s,_configuration.text.monthNames[t]);ToolTip.add(o,e,_configuration.text.closeToolTipText)}function showConfigurationDialog(e){showDisabledBackground(e),Is.defined(e._currentView.configurationDialog)&&"block"!==e._currentView.configurationDialog.style.display&&(e._currentView.configurationDialog.style.display="block");let t=[],n=[];1===e._currentView.view?(t=e.views.map.daysToShow,n=e.views.map.monthsToShow):e.views.chart.enabled&&2===e._currentView.view?(t=e.views.chart.daysToShow,n=e.views.chart.monthsToShow):e.views.days.enabled&&3===e._currentView.view?(t=e.views.days.daysToShow,n=e.views.days.monthsToShow):e.views.statistics.enabled&&4===e._currentView.view?(t=e.views.statistics.daysToShow,n=e.views.statistics.monthsToShow):(t=e.views.map.daysToShow,n=e.views.map.monthsToShow);for(let n=0;n<7;n++)e._currentView.dayCheckBoxes[n].checked=isDayVisible(t,n+1);for(let t=0;t<12;t++)e._currentView.monthCheckBoxes[t].checked=isMonthVisible(n,t);ToolTip.hide(e)}function hideConfigurationDialog(e){hideDisabledBackground(e),Is.defined(e._currentView.configurationDialog)&&"none"!==e._currentView.configurationDialog.style.display&&(e._currentView.configurationDialog.style.display="none");const t=[],n=[];let o=!1;for(let n=0;n<7;n++)e._currentView.dayCheckBoxes[n].checked&&t.push(n+1);for(let t=0;t<12;t++)e._currentView.monthCheckBoxes[t].checked&&n.push(t+1);t.length>=1&&(1===e._currentView.view?e.views.map.daysToShow=t:e.views.chart.enabled&&2===e._currentView.view?e.views.chart.daysToShow=t:e.views.days.enabled&&3===e._currentView.view?e.views.days.daysToShow=t:e.views.statistics.enabled&&4===e._currentView.view?e.views.statistics.daysToShow=t:e.views.map.daysToShow=t,o=!0),n.length>=1&&(1===e._currentView.view?e.views.map.monthsToShow=n:e.views.chart.enabled&&2===e._currentView.view?e.views.chart.monthsToShow=n:e.views.days.enabled&&3===e._currentView.view?e.views.days.monthsToShow=n:e.views.statistics.enabled&&4===e._currentView.view?e.views.statistics.monthsToShow=n:e.views.map.monthsToShow=n,o=!0),o?(renderControlContainer(e),Trigger.customEvent(e.events.onOptionsUpdate,e._currentView.element,e)):ToolTip.hide(e)}function renderControlTitleBar(e){if(e.title.showText||e.title.showYearSelector||e.title.showRefreshButton||e.title.showExportButton||e.title.showImportButton){const t=DomElement.create(e._currentView.element,"div","title-bar"),n=DomElement.create(t,"div","title");if(e.views.chart.enabled||e.views.days.enabled||e.views.statistics.enabled?e.title.showTitleDropDownButton&&DomElement.create(n,"div","down-arrow"):DomElement.addClass(n,"no-click"),e.title.showText&&(n.innerHTML+=e.title.text),(e.views.chart.enabled||e.views.days.enabled||e.views.statistics.enabled)&&renderTitleDropDownMenu(e,n),e.title.showImportButton&&!e._currentView.isInFetchMode){const n=DomElement.createWithHTML(t,"button","import",_configuration.text.importButtonSymbolText);ToolTip.add(n,e,_configuration.text.importButtonText),n.onclick=()=>{importFromFilesSelected(e)}}if(e.title.showExportButton){const n=DomElement.createWithHTML(t,"button","export",_configuration.text.exportButtonSymbolText);ToolTip.add(n,e,_configuration.text.exportButtonText),n.onclick=()=>{exportAllData(e)}}if(e.title.showRefreshButton){const n=DomElement.createWithHTML(t,"button","refresh",_configuration.text.refreshButtonSymbolText);ToolTip.add(n,e,_configuration.text.refreshButtonText),n.onclick=()=>{renderControlContainer(e),Trigger.customEvent(e.events.onRefresh,e._currentView.element)}}if(e.title.showYearSelector){const n=DomElement.createWithHTML(t,"button","back",_configuration.text.backButtonSymbolText);if(ToolTip.add(n,e,_configuration.text.backButtonText),n.onclick=()=>{moveToPreviousYear(e)},isFirstVisibleYear(e,e._currentView.year)&&(n.disabled=!0),e._currentView.yearText=DomElement.createWithHTML(t,"div","year-text",e._currentView.year.toString()),e.title.showYearSelectionDropDown?renderYearDropDownMenu(e):DomElement.addClass(e._currentView.yearText,"no-click"),e.title.showConfigurationButton){let n=DomElement.create(t,"div","configure");ToolTip.add(n,e,_configuration.text.configurationToolTipText),n.onclick=()=>{showConfigurationDialog(e)}}const o=DomElement.createWithHTML(t,"button","next",_configuration.text.nextButtonSymbolText);ToolTip.add(o,e,_configuration.text.nextButtonText),o.onclick=()=>{moveToNextYear(e)},isLastVisibleYear(e,e._currentView.year)&&(o.disabled=!0)}}}function renderTitleDropDownMenu(e,t){const n=DomElement.create(t,"div","titles-menu-container"),o=DomElement.create(n,"div","titles-menu");e.title.showTitleDropDownHeaders&&DomElement.createWithHTML(o,"div","title-menu-header",_configuration.text.dataText+":");if(renderTitleDropDownMenuItemClickEvent(e,DomElement.createWithHTML(o,"div","title-menu-item",_configuration.text.mapText),1,"map"),e.views.chart.enabled){renderTitleDropDownMenuItemClickEvent(e,DomElement.createWithHTML(o,"div","title-menu-item",_configuration.text.chartText),2,"chart")}if(e.views.days.enabled){e.title.showTitleDropDownHeaders&&DomElement.createWithHTML(o,"div","title-menu-header",_configuration.text.yearText+":");renderTitleDropDownMenuItemClickEvent(e,DomElement.createWithHTML(o,"div","title-menu-item",_configuration.text.daysText),3,"days")}if(e.views.statistics.enabled){e.title.showTitleDropDownHeaders&&DomElement.createWithHTML(o,"div","title-menu-header",_configuration.text.statisticsText+":");renderTitleDropDownMenuItemClickEvent(e,DomElement.createWithHTML(o,"div","title-menu-item",_configuration.text.colorRangesText),4,"statistics")}}function renderTitleDropDownMenuItemClickEvent(e,t,n,o){e._currentView.view===n?DomElement.addClass(t,"title-menu-item-active"):t.onclick=()=>{e._currentView.view=n,Trigger.customEvent(e.events.onViewSwitch,o),renderControlContainer(e,!1,!0)}}function renderYearDropDownMenu(e){DomElement.create(e._currentView.yearText,"div","down-arrow");const t=DomElement.create(e._currentView.yearText,"div","years-menu-container"),n=DomElement.create(t,"div","years-menu"),o=(new Date).getFullYear();let a=null;t.style.display="block",t.style.visibility="hidden";for(let t=o-e.title.extraSelectionYears;t<o+e.title.extraSelectionYears;t++)if(isYearVisible(e,t)){let i=renderYearDropDownMenuItem(e,n,t,o);Is.defined(a)||(a=i)}Is.defined(a)&&(n.scrollTop=a.offsetTop-n.offsetHeight/2),t.style.display="none",t.style.visibility="visible"}function renderYearDropDownMenuItem(e,t,n,o){let a=null;const i=DomElement.createWithHTML(t,"div","year-menu-item",n.toString());return e._currentView.year!==n?(i.onclick=()=>{e._currentView.year=n,renderControlContainer(e),Trigger.customEvent(e.events.onSetYear,e._currentView.year)},n===o&&DomElement.addClass(i,"year-menu-item-current")):(DomElement.addClass(i,"year-menu-item-active"),a=i),a}function renderControlMap(e,t){if(e._currentView.mapContents=DomElement.create(e._currentView.element,"div","map-contents"),e.views.chart.enabled&&renderControlChartContents(e),e.views.days.enabled&&renderControlDaysContents(e),e.views.statistics.enabled&&renderControlStatisticsContents(e),renderControlViewGuide(e),e.views.map.showNoDataMessageWhenDataIsNotAvailable&&!isDataAvailableForYear(e)){const n=DomElement.createWithHTML(e._currentView.mapContents,"div","no-data-message",_configuration.text.noMapDataMessage);t&&DomElement.addClass(n,"view-switch")}else{e._currentView.mapContents.style.minHeight="unset",makeAreaDroppable(e._currentView.mapContents,e);const n=DomElement.create(e._currentView.mapContents,"div","map"),o=e._currentView.year;let a=!1;if(t&&DomElement.addClass(n,"view-switch"),e.views.map.showDayNames){const t=DomElement.create(n,"div","days"),o=e.views.map.showMinimalDayNames&&7===e.views.map.daysToShow.length;e.views.map.showMonthNames&&!e.views.map.placeMonthNamesOnTheBottom||(t.className="days-months-bottom");for(let n=0;n<7;n++)if(isDayVisible(e.views.map.daysToShow,n+1)){const e=o&&n%3!=0?" ":_configuration.text.dayNames[n];DomElement.createWithHTML(t,"div","day-name",e)}e.views.map.showDaysInReverseOrder&&DomElement.reverseChildrenOrder(t)}const i=DomElement.create(n,"div","months"),r=getSortedColorRanges(e);for(let t=0;t<12;t++)if(isMonthVisible(e.views.map.monthsToShow,t)){const n=DomElement.create(i,"div","month"),s=DomElement.create(n,"div","day-columns");let l=DateTime.getTotalDaysInMonth(o,t),c=DomElement.create(s,"div","day-column"),u=!1;const d=new Date(o,t,1),m=DateTime.getWeekdayNumber(d);let g=1;l+=m;for(let n=0;n<l;n++){if(n>=m?u=!0:isDayVisible(e.views.map.daysToShow,g)&&DomElement.create(c,"div","day-disabled"),u){let a=null;if(isDayVisible(e.views.map.daysToShow,g)&&(a=renderControlMapMonthDay(e,c,n-m,t,o,r)),(n+1)%7==0&&(e.views.map.showDaysInReverseOrder&&DomElement.reverseChildrenOrder(c),c=DomElement.create(s,"div","day-column"),g=0,0===_elements_Day_Width&&Is.defined(a))){let e=DomElement.getStyleValueByName(a,"margin-left",!0),t=DomElement.getStyleValueByName(a,"margin-right",!0);_elements_Day_Width=a.offsetWidth+e+t}}g++}if(e.views.map.showMonthNames){let o;const a=n.offsetWidth;o=e.views.map.placeMonthNamesOnTheBottom?DomElement.createWithHTML(n,"div","month-name-bottom",_configuration.text.monthNames[t]):DomElement.createWithHTML(n,"div","month-name",_configuration.text.monthNames[t],s),Is.defined(o)&&(e.views.map.showMonthDayGaps?o.style.width=`${a}px`:o.style.width=a-_elements_Day_Width+"px")}a&&Is.defined(_elements_Day_Width)&&(m>0&&!e.views.map.showMonthDayGaps?n.style.marginLeft=-_elements_Day_Width+"px":0===m&&e.views.map.showMonthDayGaps&&(n.style.marginLeft=`${_elements_Day_Width}px`)),e.views.map.showMonthsInReverseOrder&&DomElement.reverseChildrenOrder(s),a=!0}e.views.map.showMonthsInReverseOrder&&DomElement.reverseChildrenOrder(i),e.views.map.keepScrollPositions&&(e._currentView.mapContents.scrollLeft=e._currentView.mapContentsScrollLeft)}}function renderControlMapMonthDay(e,t,n,o,a,i){const r=n+1,s=DomElement.create(t,"div","day"),l=new Date(a,o,r);let c=_elements_DateCounts[e._currentView.element.id].typeData[e._currentView.type][DateTime.toStorageDate(l)];c=Data.getDefaultNumber(c,0),renderDayToolTip(e,s,l,c),e.views.map.showDayNumbers&&c>0&&(s.innerHTML=c.toString()),Is.definedFunction(e.events.onDayClick)?s.onclick=()=>{Trigger.customEvent(e.events.onDayClick,l,c)}:DomElement.addClass(s,"no-hover");const u=getColorRange(e,i,c,l);return Is.defined(u)&&isColorRangeVisible(e,u.id)&&(Is.definedString(u.mapCssClassName)?DomElement.addClass(s,u.mapCssClassName):DomElement.addClass(s,u.cssClassName)),s}function isDataAvailableForYear(e){let t=!1;const n=getCurrentViewData(e),o=e._currentView.year.toString();for(let e in n)if(n.hasOwnProperty(e)&&DateTime.getStorageDateYear(e)===o){t=!0;break}return t}function renderControlChartContents(e){e._currentView.chartContents=DomElement.create(e._currentView.element,"div","chart-contents"),makeAreaDroppable(e._currentView.chartContents,e)}function renderControlChart(e,t){const n=DomElement.create(e._currentView.chartContents,"div","chart");let o=DomElement.create(n,"div","y-labels");const a=DomElement.create(n,"div","day-lines"),i=getSortedColorRanges(e),r=getLargestValueForChartYear(e),s=e._currentView.year;let l=0;if(t&&DomElement.addClass(n,"view-switch"),r>0&&e.views.chart.showChartYLabels){const e=DomElement.createWithHTML(o,"div","label-0",r.toString());DomElement.createWithHTML(o,"div","label-25",(3*Math.floor(r/4)).toString()),DomElement.createWithHTML(o,"div","label-50",Math.floor(r/2).toString()),DomElement.createWithHTML(o,"div","label-75",Math.floor(r/4).toString()),DomElement.createWithHTML(o,"div","label-100","0"),o.style.width=`${e.offsetWidth}px`,l=o.offsetWidth+DomElement.getStyleValueByName(o,"margin-right",!0)}else o.parentNode.removeChild(o),o=null;if(0===r){e._currentView.chartContents.style.minHeight=`${e._currentView.mapContents.offsetHeight}px`,n.parentNode.removeChild(n);const o=DomElement.createWithHTML(e._currentView.chartContents,"div","no-data-message",_configuration.text.noChartDataMessage);t&&DomElement.addClass(o,"view-switch")}else{const t=e._currentView.mapContents.offsetHeight/r;let n=0,o=0;for(let r=0;r<12;r++)if(isMonthVisible(e.views.chart.monthsToShow,r)){const l=DateTime.getTotalDaysInMonth(s,r);let c=1;n++;for(let n=0;n<l;n++)isDayVisible(e.views.chart.daysToShow,c)&&renderControlChartDay(a,e,n+1,r,s,i,t),(n+1)%7==0&&(c=0),c++,o++}if(e.views.chart.showInReverseOrder&&DomElement.reverseChildrenOrder(a),e.views.chart.showMonthNames){const t=DomElement.create(e._currentView.chartContents,"div","chart-months"),o=a.offsetWidth/n;let i=0;const r=n=>{if(isMonthVisible(e.views.chart.monthsToShow,n)){DomElement.createWithHTML(t,"div","month-name",_configuration.text.monthNames[n]).style.left=`${l+o*i}px`,i++}};if(e.views.chart.showInReverseOrder)for(let e=12;e--;)r(e);else for(let e=0;e<12;e++)r(e);t.style.width=`${a.offsetWidth}px`;const s=DomElement.create(t,"div","month-name-space");s.style.height=`${t.offsetHeight}px`,s.style.width=`${l}px`}e.views.chart.keepScrollPositions&&(e._currentView.chartContents.scrollLeft=e._currentView.chartContentsScrollLeft)}}function renderControlChartDay(e,t,n,o,a,i,r){const s=new Date(a,o,n),l=DomElement.create(e,"div","day-line");let c=getCurrentViewData(t)[DateTime.toStorageDate(s)];c=Data.getDefaultNumber(c,0),renderDayToolTip(t,l,s,c),t.views.chart.showLineNumbers&&c>0&&(DomElement.addClass(l,"day-line-number"),l.innerHTML=c.toString());const u=c*r;l.style.height=`${u}px`,u<=0&&(l.style.visibility="hidden"),Is.definedFunction(t.events.onDayClick)?l.onclick=()=>{Trigger.customEvent(t.events.onDayClick,s,c)}:DomElement.addClass(l,"no-hover");const d=getColorRange(t,i,c,s);Is.defined(d)&&isColorRangeVisible(t,d.id)&&(Is.definedString(d.chartCssClassName)?DomElement.addClass(l,d.chartCssClassName):DomElement.addClass(l,d.cssClassName))}function getLargestValueForChartYear(e){let t=0;const n=getCurrentViewData(e);for(let o=0;o<12;o++){const a=DateTime.getTotalDaysInMonth(e._currentView.year,o);for(let i=0;i<a;i++){const a=DateTime.toStorageDate(new Date(e._currentView.year,o,i+1));n.hasOwnProperty(a)&&isMonthVisible(e.views.chart.monthsToShow,o)&&isDayVisible(e.views.chart.daysToShow,i+1)&&(t=Math.max(t,n[a]))}}return t}function renderControlDaysContents(e){e._currentView.daysContents=DomElement.create(e._currentView.element,"div","days-contents"),makeAreaDroppable(e._currentView.daysContents,e)}function renderControlDays(e,t){const n=DomElement.create(e._currentView.daysContents,"div","days"),o=DomElement.create(e._currentView.daysContents,"div","day-names");let a=DomElement.create(n,"div","y-labels");const i=DomElement.create(n,"div","day-lines"),r=getLargestValuesForEachDay(e);if(t&&DomElement.addClass(n,"view-switch"),r.largestValue>0&&e.views.days.showChartYLabels){const e=DomElement.createWithHTML(a,"div","label-0",r.largestValue.toString());DomElement.createWithHTML(a,"div","label-25",(3*Math.floor(r.largestValue/4)).toString()),DomElement.createWithHTML(a,"div","label-50",Math.floor(r.largestValue/2).toString()),DomElement.createWithHTML(a,"div","label-75",Math.floor(r.largestValue/4).toString()),DomElement.createWithHTML(a,"div","label-100","0"),a.style.width=`${e.offsetWidth}px`,o.style.paddingLeft=`${a.offsetWidth+DomElement.getStyleValueByName(a,"margin-right",!0)}px`}else a.parentNode.removeChild(a),a=null;if(0===r.largestValue){e._currentView.daysContents.style.minHeight=`${e._currentView.mapContents.offsetHeight}px`,n.parentNode.removeChild(n),o.parentNode.removeChild(o);const a=DomElement.createWithHTML(e._currentView.daysContents,"div","no-days-message",_configuration.text.noDaysDataMessage);t&&DomElement.addClass(a,"view-switch")}else{const t=e._currentView.mapContents.offsetHeight/r.largestValue;for(let n in r.days)r.days.hasOwnProperty(n)&&isDayVisible(e.views.days.daysToShow,parseInt(n))&&(renderControlDaysDayLine(i,parseInt(n),r.days[n],e,t),e.views.days.showDayNames&&DomElement.createWithHTML(o,"div","day-name",_configuration.text.dayNames[parseInt(n)-1]));e.views.days.showInReverseOrder&&(DomElement.reverseChildrenOrder(i),DomElement.reverseChildrenOrder(o)),e.views.days.keepScrollPositions&&(e._currentView.daysContents.scrollLeft=e._currentView.daysContentsScrollLeft)}}function renderControlDaysDayLine(e,t,n,o,a){const i=DomElement.create(e,"div","day-line"),r=n*a;i.style.height=`${r}px`,r<=0&&(i.style.visibility="hidden"),ToolTip.add(i,o,n.toString()),Is.definedFunction(o.events.onWeekDayClick)?i.onclick=()=>{Trigger.customEvent(o.events.onWeekDayClick,t,n)}:DomElement.addClass(i,"no-hover"),o.views.days.showDayNumbers&&n>0&&(DomElement.addClass(i,"day-line-number"),DomElement.createWithHTML(i,"div","count",n.toString()))}function getLargestValuesForEachDay(e){const t={days:{1:0,2:0,3:0,4:0,5:0,6:0,7:0},largestValue:0},n=getCurrentViewData(e);for(let o=0;o<12;o++){const a=DateTime.getTotalDaysInMonth(e._currentView.year,o);for(let i=0;i<a;i++){const a=DateTime.toStorageDate(new Date(e._currentView.year,o,i+1));if(n.hasOwnProperty(a)){const o=DateTime.getStorageDate(a),i=new Date(parseInt(o[2]),parseInt(o[1]),parseInt(o[0])),r=DateTime.getWeekdayNumber(i)+1;!isHoliday(e,i).matched&&isMonthVisible(e.views.days.monthsToShow,i.getMonth())&&isDayVisible(e.views.days.daysToShow,r)&&(t.days[r]+=n[a],t.largestValue=Math.max(t.largestValue,t.days[r]))}}}return t}function renderControlStatisticsContents(e){e._currentView.statisticsContents=DomElement.create(e._currentView.element,"div","statistics-contents"),makeAreaDroppable(e._currentView.statisticsContents,e)}function renderControlStatistics(e,t){const n=DomElement.create(e._currentView.statisticsContents,"div","statistics"),o=DomElement.create(e._currentView.statisticsContents,"div","statistics-ranges");let a=DomElement.create(n,"div","y-labels");const i=DomElement.create(n,"div","range-lines"),r=getSortedColorRanges(e),s=getLargestValuesForEachRangeType(e,r);if(t&&DomElement.addClass(n,"view-switch"),s.largestValue>0&&e.views.statistics.showChartYLabels){const e=DomElement.createWithHTML(a,"div","label-0",s.largestValue.toString());DomElement.createWithHTML(a,"div","label-25",(3*Math.floor(s.largestValue/4)).toString()),DomElement.createWithHTML(a,"div","label-50",Math.floor(s.largestValue/2).toString()),DomElement.createWithHTML(a,"div","label-75",Math.floor(s.largestValue/4).toString()),DomElement.createWithHTML(a,"div","label-100","0"),a.style.width=`${e.offsetWidth}px`,o.style.paddingLeft=`${a.offsetWidth+DomElement.getStyleValueByName(a,"margin-right",!0)}px`}else a.parentNode.removeChild(a),a=null;if(0===s.largestValue){e._currentView.statisticsContents.style.minHeight=`${e._currentView.mapContents.offsetHeight}px`,n.parentNode.removeChild(n),o.parentNode.removeChild(o);const a=DomElement.createWithHTML(e._currentView.statisticsContents,"div","no-statistics-message",_configuration.text.noStatisticsDataMessage);t&&DomElement.addClass(a,"view-switch")}else{const t=e._currentView.mapContents.offsetHeight/s.largestValue;e.views.statistics.showColorRangeLabels||o.parentNode.removeChild(o);for(let n in s.types)if(s.types.hasOwnProperty(n)){renderControlStatisticsRangeLine(parseInt(n),i,s.types[n],e,r,t);const a=getColorRangeByMinimum(r,parseInt(n));e.views.statistics.showColorRangeLabels&&(e.views.statistics.useColorRangeNamesForLabels&&Is.defined(a)&&Is.definedString(a.name)?DomElement.createWithHTML(o,"div","range-name",a.name):DomElement.createWithHTML(o,"div","range-name",n+"+"))}e.views.statistics.showInReverseOrder&&(DomElement.reverseChildrenOrder(i),DomElement.reverseChildrenOrder(o)),e.views.statistics.keepScrollPositions&&(e._currentView.statisticsContents.scrollLeft=e._currentView.statisticsContentsScrollLeft)}}function renderControlStatisticsRangeLine(e,t,n,o,a,i){const r=DomElement.create(t,"div","range-line"),s=getColorRangeByMinimum(a,e),l=n*i;r.style.height=`${l}px`,l<=0&&(r.style.visibility="hidden"),ToolTip.add(r,o,n.toString()),o.views.statistics.showRangeNumbers&&n>0&&(DomElement.addClass(r,"range-line-number"),DomElement.createWithHTML(r,"div","count",n.toString())),Is.definedFunction(o.events.onStatisticClick)?r.onclick=()=>{Trigger.customEvent(o.events.onStatisticClick,s)}:DomElement.addClass(r,"no-hover"),Is.defined(s)&&isColorRangeVisible(o,s.id)&&(Is.definedString(s.statisticsCssClassName)?DomElement.addClass(r,s.statisticsCssClassName):DomElement.addClass(r,s.cssClassName))}function getLargestValuesForEachRangeType(e,t){const n=getCurrentViewData(e),o={types:{},largestValue:0};o.types[0]=0;for(let a=0;a<12;a++){const i=DateTime.getTotalDaysInMonth(e._currentView.year,a);for(let r=0;r<i;r++){const i=DateTime.toStorageDate(new Date(e._currentView.year,a,r+1));if(n.hasOwnProperty(i)){const a=DateTime.getStorageDate(i),r=new Date(parseInt(a[2]),parseInt(a[1]),parseInt(a[0])),s=DateTime.getWeekdayNumber(r)+1;if(!isHoliday(e,r).matched&&isMonthVisible(e.views.statistics.monthsToShow,r.getMonth())&&isDayVisible(e.views.statistics.daysToShow,s)){const a=getColorRange(e,t,n[i]);Is.defined(a)?(o.types.hasOwnProperty(a.minimum.toString())||(o.types[a.minimum.toString()]=0),o.types[a.minimum]++,o.largestValue=Math.max(o.largestValue,o.types[a.minimum])):o.types[0]++}}}}return o}function renderControlViewGuide(e){const t=DomElement.create(e._currentView.element,"div","guide"),n=DomElement.create(t,"div","map-types");let o=0;for(let t in _elements_DateCounts[e._currentView.element.id].typeData[_configuration.text.unknownTrendText])if(_elements_DateCounts[e._currentView.element.id].typeData[_configuration.text.unknownTrendText].hasOwnProperty(t)){o++;break}if(_elements_DateCounts[e._currentView.element.id].totalTypes>1){if(Is.definedString(e.description.text)){const n=DomElement.create(e._currentView.element,"div","description",t);renderDescription(e,n)}for(let t in _elements_DateCounts[e._currentView.element.id].typeData)(t!==_configuration.text.unknownTrendText||o>0)&&(0===o&&e._currentView.type===_configuration.text.unknownTrendText&&(e._currentView.type=t),renderControlViewGuideTypeButton(e,n,t))}else renderDescription(e,n);if(e.guide.enabled){const n=DomElement.create(t,"div","map-toggles");if(e.guide.showLessAndMoreLabels){let t=DomElement.createWithHTML(n,"div","less-text",_configuration.text.lessText);e.guide.colorRangeTogglesEnabled?t.onclick=()=>{updateColorRangeToggles(e,!1)}:DomElement.addClass(t,"no-click")}const o=DomElement.create(n,"div","days"),a=getSortedColorRanges(e),i=a.length;for(let t=0;t<i;t++)renderControlViewGuideDay(e,o,a[t]);if(e.guide.showLessAndMoreLabels){const t=DomElement.createWithHTML(n,"div","more-text",_configuration.text.moreText);e.guide.colorRangeTogglesEnabled?t.onclick=()=>{updateColorRangeToggles(e,!0)}:DomElement.addClass(t,"no-click")}}}function renderControlViewGuideTypeButton(e,t,n){const o=DomElement.createWithHTML(t,"button","type",n);e._currentView.type===n&&DomElement.addClass(o,"active"),o.onclick=()=>{e._currentView.type!==n&&(e._currentView.type=n,Trigger.customEvent(e.events.onTypeSwitch,n),renderControlContainer(e))}}function renderControlViewGuideDay(e,t,n){const o=DomElement.create(t,"div");o.className="day",ToolTip.add(o,e,n.tooltipText),isColorRangeVisible(e,n.id)&&(1===e._currentView.view&&Is.definedString(n.mapCssClassName)?DomElement.addClass(o,n.mapCssClassName):e.views.chart.enabled&&2===e._currentView.view&&Is.definedString(n.chartCssClassName)?DomElement.addClass(o,n.chartCssClassName):e.views.statistics.enabled&&4===e._currentView.view&&Is.definedString(n.statisticsCssClassName)?DomElement.addClass(o,n.statisticsCssClassName):DomElement.addClass(o,n.cssClassName)),e.guide.showNumbersInGuide&&(DomElement.addClass(o,"day-number"),o.innerHTML=n.minimum+"+"),e.guide.colorRangeTogglesEnabled?o.onclick=()=>{toggleColorRangeVisibleState(e,n.id)}:DomElement.addClass(o,"no-hover")}function renderDescription(e,t){if(Is.definedString(e.description.text))if(Is.definedString(e.description.url)){const n=DomElement.createWithHTML(t,"a","label",e.description.text);n.href=e.description.url,n.target=e.description.urlTarget}else DomElement.createWithHTML(t,"span","label",e.description.text)}function renderDayToolTip(e,t,n,o){if(Is.definedFunction(e.events.onDayToolTipRender))ToolTip.add(t,e,Trigger.customEvent(e.events.onDayToolTipRender,n,o));else{let o=DateTime.getCustomFormattedDateText(_configuration,e.tooltip.dayText,n);if(e.showHolidaysInDayToolTips){let t=isHoliday(e,n);t.matched&&Is.definedString(t.name)&&(o+=": "+t.name)}ToolTip.add(t,e,o)}}function createDateStorageForElement(e,t,n=!0){_elements_DateCounts[e]={options:t,typeData:{},totalTypes:1},_elements_DateCounts[e].typeData[_configuration.text.unknownTrendText]={},n&&!t._currentView.isInFetchMode&&loadDataFromLocalStorage(t)}function getCurrentViewData(e){return _elements_DateCounts[e._currentView.element.id].typeData[e._currentView.type]}function isMonthVisible(e,t){return e.indexOf(t+1)>-1}function isDayVisible(e,t){return e.indexOf(t)>-1}function getYearsAvailableInData(e){let t=[];if(e.showOnlyDataForYearsAvailable){let n=getCurrentViewData(e);for(let e in n)if(n.hasOwnProperty(e)){let n=parseInt(DateTime.getStorageDateYear(e));-1===t.indexOf(n)&&t.push(n)}}return t=t.sort((function(e,t){return e-t})),t}function isYearVisible(e,t){return-1===e.yearsToHide.indexOf(t)&&(0===e._currentView.yearsAvailable.length||e._currentView.yearsAvailable.indexOf(t)>-1)}function isFirstVisibleYear(e,t){return e._currentView.yearsAvailable.length>0&&t<=e._currentView.yearsAvailable[0]}function isLastVisibleYear(e,t){return e._currentView.yearsAvailable.length>0&&t>=e._currentView.yearsAvailable[e._currentView.yearsAvailable.length-1]}function loadDataFromLocalStorage(e){if(e.useLocalStorageForData&&window.localStorage){const t=window.localStorage.length,n=e._currentView.element.id;for(let e=0;e<t;e++){const t=window.localStorage.key(e);if(Data.String.startsWithAnyCase(t,_local_Storage_Start_ID)){const e=getObjectFromString(window.localStorage.getItem(t));if(e.parsed){_elements_DateCounts[n].typeData=e.object,_elements_DateCounts[n].totalTypes=0;for(let e in _elements_DateCounts[n].typeData)_elements_DateCounts[n].typeData.hasOwnProperty(e)&&_elements_DateCounts[n].totalTypes++}}}}}function storeDataInLocalStorage(e){if(e.useLocalStorageForData&&window.localStorage){const t=e._currentView.element.id;clearLocalStorageObjects(e);const n=JSON.stringify(_elements_DateCounts[t].typeData);window.localStorage.setItem(_local_Storage_Start_ID+t,n)}}function clearLocalStorageObjects(e){if(e.useLocalStorageForData&&window.localStorage){const t=window.localStorage.length,n=[],o=e._currentView.element.id;for(let e=0;e<t;e++)Data.String.startsWithAnyCase(window.localStorage.key(e),_local_Storage_Start_ID+o)&&n.push(window.localStorage.key(e));const a=n.length;for(let e=0;e<a;e++)window.localStorage.removeItem(n[e])}}function startDataPullTimer(e){e._currentView.isInFetchMode&&(0===e._currentView.isInFetchModeTimer&&pullDataFromCustomTrigger(e),0===e._currentView.isInFetchModeTimer&&(e._currentView.isInFetchModeTimer=setInterval((()=>{pullDataFromCustomTrigger(e),renderControlContainer(e)}),e.dataFetchDelay)))}function pullDataFromCustomTrigger(e){const t=e._currentView.element.id,n=Trigger.customEvent(e.events.onDataFetch,t);if(Is.definedObject(n)){createDateStorageForElement(t,e,!1);for(let e in n)n.hasOwnProperty(e)&&(_elements_DateCounts[t].typeData[_configuration.text.unknownTrendText].hasOwnProperty(e)||(_elements_DateCounts[t].typeData[_configuration.text.unknownTrendText][e]=0),_elements_DateCounts[t].typeData[_configuration.text.unknownTrendText][e]+=n[e])}}function cancelAllPullDataTimers(){for(let e in _elements_DateCounts)if(_elements_DateCounts.hasOwnProperty(e)){const t=_elements_DateCounts[e].options;Is.defined(t._currentView.isInFetchModeTimer)&&(clearInterval(t._currentView.isInFetchModeTimer),t._currentView.isInFetchModeTimer=0)}}function isColorRangeVisible(e,t){let n=!1;if(t===_internal_Name_Holiday)n=!0;else{const o=e.colorRanges.length;for(let a=0;a<o;a++){const o=e.colorRanges[a];if(o.id===t&&Data.getDefaultBoolean(o.visible,!0)){n=!0;break}}}return n}function updateColorRangeToggles(e,t){const n=e.colorRanges.length;for(let o=0;o<n;o++)e.colorRanges[o].visible=t,Trigger.customEvent(e.events.onColorRangeTypeToggle,e.colorRanges[o].id,t);renderControlContainer(e)}function toggleColorRangeVisibleState(e,t){const n=e.colorRanges.length;for(let o=0;o<n;o++){const n=e.colorRanges[o];if(n.id===t){n.visible=!Data.getDefaultBoolean(n.visible,!0),Trigger.customEvent(e.events.onColorRangeTypeToggle,n.id,n.visible),renderControlContainer(e);break}}}function getColorRange(e,t,n,o=null){let a=null;if(Is.defined(o)&&isHoliday(e,o).matched&&(a={cssClassName:"holiday",id:_internal_Name_Holiday,visible:!0,minimum:0}),!Is.defined(a)){const e=t.length;for(let o=0;o<e;o++){const e=t[o];if(!(n>=e.minimum))break;a=e}}return a}function getColorRangeByMinimum(e,t){const n=e.length;let o=null;for(let a=0;a<n;a++){const n=e[a];if(t.toString()===n.minimum.toString()){o=n;break}}return o}function getSortedColorRanges(e){return e.colorRanges.sort((function(e,t){return e.minimum-t.minimum}))}function isHoliday(e,t){const n={matched:!1,name:null},o=e.holidays.length,a=t.getDate(),i=t.getMonth()+1,r=t.getFullYear();for(let t=0;t<o;t++){let o=e.holidays[t];if(Is.definedString(o.date)&&o.showInViews){const e=o.date.split("/");if(2===e.length?n.matched=a===parseInt(e[0])&&i===parseInt(e[1]):3===e.length&&(n.matched=a===parseInt(e[0])&&i===parseInt(e[1])&&r===parseInt(e[2])),n.matched){n.name=o.name;break}}}return n}function makeAreaDroppable(e,t){t.allowFileImports&&!t._currentView.isInFetchMode&&(e.ondragover=DomElement.cancelBubble,e.ondragenter=DomElement.cancelBubble,e.ondragleave=DomElement.cancelBubble,e.ondrop=e=>{DomElement.cancelBubble(e),Is.defined(window.FileReader)&&e.dataTransfer.files.length>0&&importFromFiles(e.dataTransfer.files,t)})}function importFromFilesSelected(e){const t=DomElement.createWithNoContainer("input");t.type="file",t.accept=".json, .txt, .csv",t.multiple=!0,t.onchange=()=>{importFromFiles(t.files,e)},t.click()}function importFromFiles(e,t){const n=e.length,o=[],a=getCurrentViewData(t),i=(e,i)=>{o.push(e);for(let e in i)i.hasOwnProperty(e)&&(a.hasOwnProperty(e)||(a[e]=0),a[e]+=i[e]);o.length===n&&(Trigger.customEvent(t.events.onImport,t._currentView.element),renderControlContainer(t))};for(let t=0;t<n;t++){const n=e[t],o=n.name.split(".").pop().toLowerCase();"json"===o?importFromJson(n,i):"txt"===o?importFromTxt(n,i):"csv"===o&&importFromCsv(n,i)}}function importFromJson(e,t){const n=new FileReader;let o={};n.readAsText(e),n.onloadend=()=>{t(e.name,o)},n.onload=e=>{const t=getObjectFromString(e.target.result);t.parsed&&Is.definedObject(t.object)&&(o=t.object)}}function importFromTxt(e,t){const n=new FileReader,o={};n.readAsText(e),n.onloadend=()=>{t(e.name,o)},n.onload=e=>{const t=e.target.result.toString().split("\n"),n=t.length;for(let e=0;e<n;e++){const n=t[e].split(":");o[n[0].trim()]=parseInt(n[1].trim())}}}function importFromCsv(e,t){const n=new FileReader,o={};n.readAsText(e),n.onloadend=()=>{t(e.name,o)},n.onload=e=>{const t=e.target.result.toString().replace(new RegExp('"',"g"),"").split("\n");t.shift();let n=t.length;for(let e=0;e<n;e++){let n=t[e].split(",");o[n[0].trim()]=parseInt(n[1].trim())}}}function exportAllData(e,t=null){let n=null;const o=getExportMimeType(e),a=Data.getDefaultString(t,e.exportType).toLowerCase();if("csv"===a?n=getCsvContent(e):"json"===a?n=getJsonContent(e):"xml"===a?n=getXmlContents(e):"txt"===a&&(n=getTxtContents(e)),Is.definedString(n)){const t=DomElement.create(document.body,"a");t.style.display="none",t.setAttribute("target","_blank"),t.setAttribute("href",`data:${o};charset=utf-8,${encodeURIComponent(n)}`),t.setAttribute("download",getExportFilename(e)),t.click(),document.body.removeChild(t),Trigger.customEvent(e.events.onExport,e._currentView.element)}}function getCsvContent(e){const t=getExportData(e),n=[];for(let e in t)t.hasOwnProperty(e)&&n.push(getCsvValueLine([getCsvValue(e),getCsvValue(t[e].toString())]));return n.length>0&&n.unshift(getCsvValueLine([getCsvValue(_configuration.text.dateText),getCsvValue(_configuration.text.countText)])),n.join("\n")}function getJsonContent(e){return JSON.stringify(getExportData(e))}function getXmlContents(e){const t=getExportData(e),n=[];n.push('<?xml version="1.0" ?>'),n.push("<Dates>");for(let e in t)t.hasOwnProperty(e)&&(n.push("<Date>"),n.push(`<FullDate>${e}</FullDate>`),n.push(`<Count>${t[e].toString()}</Count>`),n.push("</Date>"));return n.push("</Dates>"),n.join("\n")}function getTxtContents(e){const t=getExportData(e),n=[];for(let e in t)t.hasOwnProperty(e)&&n.push(e+": "+t[e].toString());return n.join("\n")}function getExportData(e){const t={},n=getCurrentViewData(e);if(e.exportOnlyYearBeingViewed)for(let o=0;o<12;o++){const a=DateTime.getTotalDaysInMonth(e._currentView.year,o);for(let i=0;i<a;i++){const a=DateTime.toStorageDate(new Date(e._currentView.year,o,i+1));n.hasOwnProperty(a)&&(t[a]=n[a])}}else{const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push(t);e.sort();const o=e.length;for(let a=0;a<o;a++){const o=e[a];n.hasOwnProperty(o)&&(t[o]=n[o])}}return t}function getExportMimeType(e){let t=null;return"csv"===e.exportType.toLowerCase()?t="text/csv":"json"===e.exportType.toLowerCase()?t="application/json":"xml"===e.exportType.toLowerCase()?t="application/xml":"txt"===e.exportType.toLowerCase()&&(t="text/plain"),t}function getExportFilename(e){const t=new Date,n=Data.String.padNumber(t.getDate())+"-"+Data.String.padNumber(t.getMonth()+1)+"-"+t.getFullYear(),o=Data.String.padNumber(t.getHours())+"-"+Data.String.padNumber(t.getMinutes());let a="";return e._currentView.type!==_configuration.text.unknownTrendText&&(a=e._currentView.type.toLowerCase().replace(" ","_")+"_"),`${a+n+"_"+o}.${e.exportType.toLowerCase()}`}function getCsvValue(e){let t=e.toString().replace(/(\r\n|\n|\r)/gm,"").replace(/(\s\s)/gm," ");return t=t.replace(/"/g,'""'),t='"'+t+'"',t}function getCsvValueLine(e){return e.join(",")}function getObjectFromString(objectString){const result={parsed:!0,object:null};try{Is.definedString(objectString)&&(result.object=JSON.parse(objectString))}catch(e1){try{result.object=eval(`(${objectString})`),Is.definedFunction(result.object)&&(result.object=result.object())}catch(e){_configuration.safeMode||(console.error(_configuration.text.objectErrorText.replace("{{error_1}}",e1.message).replace("{{error_2}}",e.message)),result.parsed=!1),result.object=null}}return result}function moveToPreviousYear(e,t=!0){let n=!0,o=e._currentView.year;for(o--;!isYearVisible(e,o);){if(isFirstVisibleYear(e,o)){n=!1;break}o--}n&&(e._currentView.year=o,renderControlContainer(e),t&&Trigger.customEvent(e.events.onBackYear,e._currentView.year))}function moveToNextYear(e,t=!0){let n=!0,o=e._currentView.year;for(o++;!isYearVisible(e,o);){if(isLastVisibleYear(e,o)){n=!1;break}o++}n&&(e._currentView.year=o,renderControlContainer(e),t&&Trigger.customEvent(e.events.onBackYear,e._currentView.year))}function destroyElement(e){e._currentView.element.innerHTML="",DomElement.removeClass(e._currentView.element,"heat-js"),ToolTip.assignToEvents(e,!1),document.body.removeChild(e._currentView.tooltip),e._currentView.isInFetchMode&&Is.defined(e._currentView.isInFetchModeTimer)&&clearInterval(e._currentView.isInFetchModeTimer),Trigger.customEvent(e.events.onDestroy,e._currentView.element)}function buildDefaultConfiguration(e=null){_configuration=Data.getDefaultObject(e,{}),_configuration.safeMode=Data.getDefaultBoolean(_configuration.safeMode,!0),_configuration.domElementTypes=Data.getDefaultStringOrArray(_configuration.domElementTypes,["*"]),buildDefaultConfigurationStrings(),buildDefaultConfigurationArrays()}function buildDefaultConfigurationStrings(){_configuration.text=Data.getDefaultObject(_configuration.text,{}),_configuration.text.stText=Data.getDefaultAnyString(_configuration.text.stText,"st"),_configuration.text.ndText=Data.getDefaultAnyString(_configuration.text.ndText,"nd"),_configuration.text.rdText=Data.getDefaultAnyString(_configuration.text.rdText,"rd"),_configuration.text.thText=Data.getDefaultAnyString(_configuration.text.thText,"th"),_configuration.text.backButtonText=Data.getDefaultAnyString(_configuration.text.backButtonText,"Back"),_configuration.text.nextButtonText=Data.getDefaultAnyString(_configuration.text.nextButtonText,"Next"),_configuration.text.refreshButtonText=Data.getDefaultAnyString(_configuration.text.refreshButtonText,"Refresh"),_configuration.text.exportButtonText=Data.getDefaultAnyString(_configuration.text.exportButtonText,"Export"),_configuration.text.lessText=Data.getDefaultAnyString(_configuration.text.lessText,"Less"),_configuration.text.moreText=Data.getDefaultAnyString(_configuration.text.moreText,"More"),_configuration.text.dateText=Data.getDefaultAnyString(_configuration.text.dateText,"Date"),_configuration.text.countText=Data.getDefaultAnyString(_configuration.text.countText,"Count"),_configuration.text.mapText=Data.getDefaultAnyString(_configuration.text.mapText,"Map"),_configuration.text.chartText=Data.getDefaultAnyString(_configuration.text.chartText,"Chart"),_configuration.text.noChartDataMessage=Data.getDefaultAnyString(_configuration.text.noChartDataMessage,"There is currently no data to view."),_configuration.text.statisticsText=Data.getDefaultAnyString(_configuration.text.statisticsText,"Statistics"),_configuration.text.noStatisticsDataMessage=Data.getDefaultAnyString(_configuration.text.noStatisticsDataMessage,"There are currently no statistics to view."),_configuration.text.unknownTrendText=Data.getDefaultAnyString(_configuration.text.unknownTrendText,"Unknown"),_configuration.text.importButtonText=Data.getDefaultAnyString(_configuration.text.importButtonText,"Import"),_configuration.text.noMapDataMessage=Data.getDefaultAnyString(_configuration.text.noMapDataMessage,"There is currently no data to view."),_configuration.text.objectErrorText=Data.getDefaultAnyString(_configuration.text.objectErrorText,"Errors in object: {{error_1}}, {{error_2}}"),_configuration.text.attributeNotValidErrorText=Data.getDefaultAnyString(_configuration.text.attributeNotValidErrorText,"The attribute '{{attribute_name}}' is not a valid object."),_configuration.text.attributeNotSetErrorText=Data.getDefaultAnyString(_configuration.text.attributeNotSetErrorText,"The attribute '{{attribute_name}}' has not been set correctly."),_configuration.text.closeToolTipText=Data.getDefaultAnyString(_configuration.text.closeToolTipText,"Close"),_configuration.text.configurationToolTipText=Data.getDefaultAnyString(_configuration.text.configurationToolTipText,"Configuration"),_configuration.text.configurationTitleText=Data.getDefaultAnyString(_configuration.text.configurationTitleText,"Configuration"),_configuration.text.visibleMonthsText=Data.getDefaultAnyString(_configuration.text.visibleMonthsText,"Visible Months"),_configuration.text.visibleDaysText=Data.getDefaultAnyString(_configuration.text.visibleDaysText,"Visible Days"),_configuration.text.dataText=Data.getDefaultAnyString(_configuration.text.dataText,"Data"),_configuration.text.colorRangesText=Data.getDefaultAnyString(_configuration.text.colorRangesText,"Color Ranges"),_configuration.text.yearText=Data.getDefaultAnyString(_configuration.text.yearText,"Year"),_configuration.text.daysText=Data.getDefaultAnyString(_configuration.text.daysText,"Days"),_configuration.text.noDaysDataMessage=Data.getDefaultAnyString(_configuration.text.noDaysDataMessage,"There are currently no days to view."),_configuration.text.backButtonSymbolText=Data.getDefaultAnyString(_configuration.text.backButtonSymbolText,""),_configuration.text.nextButtonSymbolText=Data.getDefaultAnyString(_configuration.text.nextButtonSymbolText,""),_configuration.text.refreshButtonSymbolText=Data.getDefaultAnyString(_configuration.text.refreshButtonSymbolText,""),_configuration.text.exportButtonSymbolText=Data.getDefaultAnyString(_configuration.text.exportButtonSymbolText,""),_configuration.text.importButtonSymbolText=Data.getDefaultAnyString(_configuration.text.importButtonSymbolText,"")}function buildDefaultConfigurationArrays(){Is.invalidOptionArray(_configuration.text.monthNames,12)&&(_configuration.text.monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),Is.invalidOptionArray(_configuration.text.dayNames,7)&&(_configuration.text.dayNames=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"])}const _public={addDates:function(e,t,n=null,o=!0){if(Is.definedString(e)&&Is.definedArray(t)&&_elements_DateCounts.hasOwnProperty(e)){const a=_elements_DateCounts[e].options;if(!a._currentView.isInFetchMode){n=Data.getDefaultString(n,_configuration.text.unknownTrendText);const i=t.length;for(let o=0;o<i;o++)_public.addDate(e,t[o],n,!1);o&&renderControlContainer(a,!0)}}return _public},addDate:function(e,t,n=null,o=!0){if(Is.definedString(e)&&Is.definedDate(t)&&_elements_DateCounts.hasOwnProperty(e)){const a=_elements_DateCounts[e].options;if(!a._currentView.isInFetchMode){n=Data.getDefaultString(n,_configuration.text.unknownTrendText);const i=DateTime.toStorageDate(t);_elements_DateCounts[e].typeData.hasOwnProperty(n)||(_elements_DateCounts[e].typeData[n]={},_elements_DateCounts[e].totalTypes++),_elements_DateCounts[e].typeData[n].hasOwnProperty(i)||(_elements_DateCounts[e].typeData[n][i]=0),_elements_DateCounts[e].typeData[n][i]++,Trigger.customEvent(a.events.onAdd,a._currentView.element),o&&renderControlContainer(a,!0)}}return _public},updateDate:function(e,t,n,o=null,a=!0){if(Is.definedString(e)&&Is.definedDate(t)&&_elements_DateCounts.hasOwnProperty(e)){const i=_elements_DateCounts[e].options;if(!i._currentView.isInFetchMode&&n>0){const r=DateTime.toStorageDate(t);_elements_DateCounts[e].typeData.hasOwnProperty(o)&&(o=Data.getDefaultString(o,_configuration.text.unknownTrendText),_elements_DateCounts[e].typeData[o][r]=n,Trigger.customEvent(i.events.onUpdate,i._currentView.element),a&&renderControlContainer(i,!0))}}return _public},removeDates:function(e,t,n=null,o=!0){if(Is.definedString(e)&&Is.definedArray(t)&&_elements_DateCounts.hasOwnProperty(e)){const a=_elements_DateCounts[e].options;if(!a._currentView.isInFetchMode){n=Data.getDefaultString(n,_configuration.text.unknownTrendText);const i=t.length;for(let o=0;o<i;o++)_public.removeDate(e,t[o],n,!1);o&&renderControlContainer(a,!0)}}return _public},removeDate:function(e,t,n=null,o=!0){if(Is.definedString(e)&&Is.definedDate(t)&&_elements_DateCounts.hasOwnProperty(e)){const a=_elements_DateCounts[e].options;if(!a._currentView.isInFetchMode){const i=DateTime.toStorageDate(t);_elements_DateCounts[e].typeData.hasOwnProperty(n)&&_elements_DateCounts[e].typeData[n].hasOwnProperty(i)&&(n=Data.getDefaultString(n,_configuration.text.unknownTrendText),_elements_DateCounts[e].typeData[n][i]>0&&_elements_DateCounts[e].typeData[n][i]--,Trigger.customEvent(a.events.onRemove,a._currentView.element),o&&renderControlContainer(a,!0))}}return _public},clearDate:function(e,t,n=null,o=!0){if(Is.definedString(e)&&Is.definedDate(t)&&_elements_DateCounts.hasOwnProperty(e)){const a=_elements_DateCounts[e].options;if(!a._currentView.isInFetchMode){const i=DateTime.toStorageDate(t);_elements_DateCounts[e].typeData.hasOwnProperty(n)&&_elements_DateCounts[e].typeData[n].hasOwnProperty(i)&&(n=Data.getDefaultString(n,_configuration.text.unknownTrendText),delete _elements_DateCounts[e].typeData[n][i],Trigger.customEvent(a.events.onClear,a._currentView.element),o&&renderControlContainer(a,!0))}}return _public},resetAll:function(e=!0){for(let t in _elements_DateCounts)_elements_DateCounts.hasOwnProperty(t)&&_public.reset(t,e);return _public},reset:function(e,t=!0){if(Is.definedString(e)&&_elements_DateCounts.hasOwnProperty(e)){const n=_elements_DateCounts[e].options;n._currentView.isInFetchMode||(n._currentView.type=_configuration.text.unknownTrendText,createDateStorageForElement(e,n,!1),Trigger.customEvent(n.events.onReset,n._currentView.element),t&&renderControlContainer(n,!0))}return _public},import:function(e,t=null){return Is.definedString(e)&&_elements_DateCounts.hasOwnProperty(e)&&(Is.definedArray(t)?importFromFiles(t,_elements_DateCounts[e].options):importFromFilesSelected(_elements_DateCounts[e].options)),_public},export:function(e,t=null){return Is.definedString(e)&&_elements_DateCounts.hasOwnProperty(e)&&exportAllData(_elements_DateCounts[e].options,t),_public},refresh:function(e){if(Is.definedString(e)&&_elements_DateCounts.hasOwnProperty(e)){const t=_elements_DateCounts[e].options;renderControlContainer(t,!0),Trigger.customEvent(t.events.onRefresh,t._currentView.element)}return _public},refreshAll:function(){for(let e in _elements_DateCounts)if(_elements_DateCounts.hasOwnProperty(e)){const t=_elements_DateCounts[e].options;renderControlContainer(t,!0),Trigger.customEvent(t.events.onRefresh,t._currentView.element)}return _public},setYear:function(e,t){if(Is.definedString(e)&&Is.definedNumber(t)&&_elements_DateCounts.hasOwnProperty(e)){const n=_elements_DateCounts[e].options;n._currentView.year=t,isYearVisible(n,n._currentView.year)?renderControlContainer(n):moveToNextYear(n,!1),Trigger.customEvent(n.events.onSetYear,n._currentView.year)}return _public},setYearToHighest:function(e){if(Is.definedString(e)&&_elements_DateCounts.hasOwnProperty(e)){const t=_elements_DateCounts[e].options,n=getCurrentViewData(t);let o=0;for(let e in n)n.hasOwnProperty(e)&&(o=Math.max(o,parseInt(DateTime.getStorageDateYear(e))));o>0&&(t._currentView.year=o,isYearVisible(t,t._currentView.year)?renderControlContainer(t):moveToNextYear(t,!1),Trigger.customEvent(t.events.onSetYear,t._currentView.year))}return _public},setYearToLowest:function(e){if(Is.definedString(e)&&_elements_DateCounts.hasOwnProperty(e)){const t=_elements_DateCounts[e].options,n=getCurrentViewData(t);let o=9999;for(let e in n)n.hasOwnProperty(e)&&(o=Math.min(o,parseInt(DateTime.getStorageDateYear(e))));o<9999&&(t._currentView.year=o,isYearVisible(t,t._currentView.year)?renderControlContainer(t):moveToPreviousYear(t,!1),Trigger.customEvent(t.events.onSetYear,t._currentView.year))}return _public},moveToPreviousYear:function(e){return Is.definedString(e)&&_elements_DateCounts.hasOwnProperty(e)&&moveToPreviousYear(_elements_DateCounts[e].options),_public},moveToNextYear:function(e){return Is.definedString(e)&&_elements_DateCounts.hasOwnProperty(e)&&moveToNextYear(_elements_DateCounts[e].options),_public},moveToCurrentYear:function(e){if(Is.definedString(e)&&_elements_DateCounts.hasOwnProperty(e)){const t=_elements_DateCounts[e].options;t._currentView.year=(new Date).getFullYear(),isYearVisible(t,t._currentView.year)?renderControlContainer(t):moveToNextYear(t,!1),Trigger.customEvent(t.events.onSetYear,t._currentView.year)}return _public},getYear:function(e){let t=-1;if(Is.definedString(e)&&_elements_DateCounts.hasOwnProperty(e)){t=_elements_DateCounts[e].options._currentView.year}return t},render:function(e,t){return Is.definedObject(e)&&Is.definedObject(t)&&renderControl(renderBindingOptions(t,e)),_public},renderAll:function(){return render(),_public},switchView:function(e,t){if(Is.definedString(e)&&Is.definedString(t)&&_elements_DateCounts.hasOwnProperty(e)){const n=_elements_DateCounts[e].options;let o;o="map"===t.toLowerCase()?1:"chart"===t.toLowerCase()?2:"days"===t.toLowerCase()?3:"statistics"===t.toLowerCase()?4:1,Is.definedNumber(o)&&(n._currentView.view=o,Trigger.customEvent(n.events.onViewSwitch,t),renderControlContainer(n,!1,!0))}return _public},switchType:function(e,t){if(Is.definedString(e)&&Is.definedString(t)&&_elements_DateCounts.hasOwnProperty(e)&&_elements_DateCounts[e].typeData.hasOwnProperty(t)){const n=_elements_DateCounts[e].options;n._currentView.type!==t&&(n._currentView.type=t,Trigger.customEvent(n.events.onTypeSwitch,t),renderControlContainer(n))}return _public},updateOptions:function(e,t){if(Is.definedString(e)&&Is.definedObject(t)&&_elements_DateCounts.hasOwnProperty(e)){const n=_elements_DateCounts[e].options,o=binding.options.get(t);let a=!1;for(let e in o)o.hasOwnProperty(e)&&n.hasOwnProperty(e)&&n[e]!==o[e]&&(n[e]=o[e],a=!0);a&&(renderControlContainer(n,!0),Trigger.customEvent(n.events.onRefresh,n._currentView.element),Trigger.customEvent(n.events.onOptionsUpdate,n._currentView.element,n))}return _public},destroyAll:function(){for(let e in _elements_DateCounts)_elements_DateCounts.hasOwnProperty(e)&&destroyElement(_elements_DateCounts[e].options);return _elements_DateCounts={},_public},destroy:function(e){return Is.definedString(e)&&_elements_DateCounts.hasOwnProperty(e)&&(destroyElement(_elements_DateCounts[e].options),delete _elements_DateCounts[e]),_public},setConfiguration:function(e,t=!0){if(Is.definedObject(e)){let n=!1;const o=_configuration;for(let t in e)e.hasOwnProperty(t)&&_configuration.hasOwnProperty(t)&&o[t]!==e[t]&&(o[t]=e[t],n=!0);n&&(buildDefaultConfiguration(o),t&&_public.refreshAll())}return _public},getIds:function(){const e=[];for(let t in _elements_DateCounts)_elements_DateCounts.hasOwnProperty(t)&&e.push(t);return e},getVersion:function(){return"4.1.0"}};buildDefaultConfiguration(),document.addEventListener("DOMContentLoaded",(()=>{render()})),window.addEventListener("pagehide",(()=>{cancelAllPullDataTimers()})),Is.defined(window.$heat)||(window.$heat=_public)})();